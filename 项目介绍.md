# GANForCartoon: 人像照片卡通化

这个Python项目是一个图像处理系统，它通过一系列的步骤将一张人像照片转换成卡通风格的图像。

## 项目概述

该项目利用深度学习模型和计算机视觉技术，将人像照片转换成卡通风格的图像。它包括以下步骤：

1. **人脸检测与矫正**：使用`FaceDetect`类，基于`dlib`库来检测图像中的人脸，并获取人脸关键点。通过`get_face`函数，对检测到的人脸进行矫正，确保人脸是正面的。
2. **人脸分割**：利用`U2NET`模型，一个用于图像分割的深度学习模型，来从人脸中分离出前景（人脸）和背景。`get_mask_U2net`函数处理分割过程，并生成人脸的掩码。
3. **背景替换**：`get_face_white_bg_photo2cartoon`函数将分割出的人脸背景替换为白色，为后续的风格迁移做准备。
4. **风格迁移**：使用`Photo2Cartoon_ResnetGenerator`模型，基于`ResNet`架构，将真实的人脸图像转换成卡通风格。`get_cartoon_face_photo2cartoon`函数负责应用风格迁移，生成最终的卡通图像。
5. **图像保存与展示**：将处理后的图像保存到指定的目录，并使用`matplotlib.pyplot`展示结果。

## 关键组件和功能

### 输入与输出

- **输入**：一张人像照片，可以是任何格式（如.jpg, .png等）。
- **输出**：经过卡通化处理的图像，背景为白色，风格卡通化。

### 参数设置

在`main.py`文件中的`parse_opt()`方法中修改默认参数：

- `--img-name`：填写放在`dataset/img`中人脸图片的名字，如`nini.png`。
- `--shear-rate`：人脸剪切的比例大小，数值越大，剪切的就越大，默认为`0.8`。
- `--segment-model`：选择人脸分割所使用的模型，有`U2net`。
- `--migration-method`：选择卡通图像风格迁移模型，有`Photo2cartoon`。

### 依赖库

- `torch`：用于构建和训练神经网络模型。
- `torchvision`：提供了处理图像的常用工具。
- `numpy`：处理数值计算。
- `cv2 (OpenCV)`：用于图像处理。
- `matplotlib`：用于数据可视化。
- `PIL`：用于图像文件的读取和写入。
- `argparse`：解析命令行参数。

## 使用说明

用户可以通过命令行参数指定输入图像的名称、裁剪比例、分割模型和风格迁移方法。项目通过`parse_opt`函数解析这些参数，并在主函数中执行整个流程。

## 项目结构

- `main.py`：项目主文件，包含所有的处理流程和函数。
- `dataloater`：包含数据加载器的模块。
- `utils`：包含辅助功能的模块，如人脸检测。
- `model`：包含用于人脸分割和风格迁移的模型。
- `dataset`：包含输入和输出的的图像


## 运行环境

项目需要Python环境，以及上述提到的所有依赖库。

## 注意事项

- 确保所有依赖库都已正确安装。
- 输入的图像应具有足够的分辨率，以获得最佳的分割和风格迁移效果。
- 项目中的模型可能需要根据用户的具体需求进行微调。

## 应用场景和发展方向

### 应用场景

- 社交媒体和娱乐
- 游戏和动画制作
- 教育和培训
- 个性化商品
- 广告和营销
- 艺术创作

### 未来发展方向

- 增加更多风格迁移模型
- 增强用户交互性
- 多风格迁移
- 实时处理
- 移动端应用
